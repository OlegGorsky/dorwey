<div class="fly-container">
  <article id="fly-special-block">
    <img src="https://files.salebot.pro/uploads/file_item/file/44501/Telegram.png" alt="Telegram Icon" class="fly-img" />
  </article>

  <div class="container">
    <span id="unique-text">ü™ô+300</span>
  </div>
  
  <div id="fly-foot">
    –ü–æ–¥–ø–∏—Å—ã–≤–∞–π—Å—è –Ω–∞ Telegram-–∫–∞–Ω–∞–ª: 
    <a href="https://t.me/ezhhhhhhhhhhhhhhhhhhh">–ï–∂ –ø—Ä–æ –¥–µ–Ω—å–≥–∏ ü¶î</a>
  </div>
  
  <div id="button-container" class="button-container">
    <button id="check-subscription">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É</button>
  </div>
</div>

<style>
  .fly-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    padding: 10px;
    box-sizing: border-box;
    max-width: 300px;
    margin: 0 auto;
  }

  #fly-special-block {
    display: flex;
    justify-content: center;
    margin-bottom: 20px;
  }

  .fly-img {
    width: 80px;
    height: 80px;
  }

  .container {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 10px;
  }

  #unique-icon {
    width: 30px;
    height: 30px;
    margin-bottom: 5px;
  }

  #unique-text {
    font-size: 24px;
    font-weight: bold;
    color: #fff;
  }

  #fly-foot {
    font-size: 14px;
    color: white;
    text-align: center;
    margin-bottom: 15px;
  }

  a:link {
    color: #00D6CA;
    text-decoration: none;
  }

  .button-container {
    width: 100%;
    display: flex;
    justify-content: center;
    margin-top: 10px;
  }

  #check-subscription {
    width: 250px;
    height: 50px;
    border-radius: 8px;
    background-color: #00D6CA;
    color: black;
    font-size: 18px;
    font-weight: 800;
    box-shadow: 0 0 10px rgba(0, 214, 202, 0.5);
    cursor: pointer;
    border: none;
  }
</style>

<script>
  if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.initDataUnsafe) {
    const userId = window.Telegram.WebApp.initDataUnsafe.user.id;

    const checkSubscriptionStatus = async () => {
      try {
        // –§–æ—Ä–º–∏—Ä—É–µ–º GET-–∑–∞–ø—Ä–æ—Å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º userId
        const response = await fetch(`https://gorskyapp.ru/api/check-subscription?userId=${userId}`, {
          method: 'GET'
        });
        const data = await response.json();

        // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞
        if (data.is_subscribed) {
          if (data.message === 'User subscribed, points added.') {
            alert('–û—Ç–ª–∏—á–Ω–æ! –¢–µ–±–µ –Ω–∞—á–∏—Å–ª–µ–Ω–æ 300 –ï–∂–ö–æ–∏–Ω–æ–≤!');
          } else {
            alert('–¢—ã —É–∂–µ –ø–æ–ª—É—á–∏–ª —Å–≤–æ–∏ 300 –ï–∂–ö–æ–∏–Ω–æ–≤ –∑–∞ –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ –∫–∞–Ω–∞–ª!');
          }
        } else {
          alert('–°–Ω–∞—á–∞–ª–∞ –ø–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ –∫–∞–Ω–∞–ª –∏ –Ω–∞–∂–º–∏ –µ—â–µ —Ä–∞–∑ –Ω–∞ –∫–Ω–æ–ø–∫—É.');
        }
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –ø–æ–¥–ø–∏—Å–∫–∏:', error);
        alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞ –ø–æ–∑–∂–µ.');
      }
    };

    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É
    document.getElementById('check-subscription').addEventListener('click', checkSubscriptionStatus);
  } else {
    console.error('Telegram WebApp API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Telegram WebApp.');
  }
</script>
